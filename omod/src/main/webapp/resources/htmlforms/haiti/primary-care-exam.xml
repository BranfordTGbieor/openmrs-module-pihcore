<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->

<htmlform formUuid="b34b71f4-03f1-11e5-8418-1697f925ec7b" formName="Examen physique"
          formEncounterType="0a9facff-fdc4-4aa9-aae0-8d7feaf5b3ef" formVersion="1.0">

    <style type="text/css">
        <ifMode mode="VIEW" include="false">
            #data-collection {
            display: inline-block;
            width: 58%;
            vertical-align: top;
            }

            #primaryCareExam input[type="checkbox"] {
            margin: 0px 5px; /*changed values to vertical, horizontal*/
            top:5px; /*added to offset the checkbox position to line up*/
            }
        </ifMode>
    </style>

    <script type="text/javascript">
        jq(function() {
            // hack--if there is only one location option, hide the location question (but set it on submit)
            if(jq('#encounterLocation option').size() == 2) {  // "Choose a location..." + 1 location = 2 option elements
                beforeSubmit.push(function() {
                    NavigatorController.getQuestionById('location').enable();
                    setValue('encounterLocation.value', getField('encounterLocation.value').find('option:nth(1)').val());  // nth(1) == second element, ie the location element
                    return true;
                })
                NavigatorController.getQuestionById('location').hide();
            }
        });
    </script>

    <!-- Pediatrics only content, hidden by default, shown (via above javascript) if pediatrics visit -->
    <!-- Note that I'm just hiding the content so that the viewing via HtmlFormEncounterController.encounterSchemaViaJson will still work in VIEW mode with no visit informatin present -->
    <excludeIf velocityTest="$visit.getVisitAttribute('Visit Template') == 'pedsInitialOutpatient' || $visit.getVisitAttribute('Visit Template') == 'pedsFollowupOutpatient'" >
        <script type="text/javascript">
            jq(function() {
                NavigatorController.getQuestionById('gross-motor-skills-exam').hide();
                NavigatorController.getQuestionById('fine-motor-skills-exam').hide();
                NavigatorController.getQuestionById('language-development-evaluation').hide();
                NavigatorController.getQuestionById('social-skills-evaluation').hide();
            });
        </script>
    </excludeIf>

    <section id="primaryCareExam" sectionTag="section" headerStyle="title" headerCode="pihcore.exam.title">

        <!-- users with retroConsultNote privilege can edit provider, location, and date for both retro and active visits -->
        <includeIf velocityTest="$user.hasPrivilege('Task: emr.retroConsultNote')">
            <fieldset class="encounter-date required">
                <legend>
                    <uimessage code="emr.patientDashBoard.date"/>
                </legend>
                <h3>
                    <uimessage code="emr.patientDashBoard.date"/>
                </h3>

                <p class="left">
                    <encounterDate id="encounterDate" showTime="false" default="now"/>
                </p>
            </fieldset>

            <fieldset class="encounter-provider required">
                <legend>
                    <uimessage code="emr.patientDashBoard.providerRequired"/>
                </legend>
                <h3>
                    <uimessage code="emr.patientDashBoard.providerRequired"/>
                </h3>

                <p class="left">
                    <encounterProviderAndRole default="currentUser" encounterRole="98bf2792-3f0a-4388-81bb-c78b29c0df92"
                                              required="true"/>
                </p>
            </fieldset>

            <fieldset id="location" class="encounter-location required">
                <legend>
                    <uimessage code="emr.locationRequired"/>
                </legend>
                <h3>
                    <uimessage code="emr.locationRequired"/>
                </h3>

                <p class="left">
                    <encounterLocation required="true" tags="Check-In Location"/>
                </p>
            </fieldset>
        </includeIf>

        <!-- users with retroConsultNoteThisProviderOnly can edit location and date (but not provider) for retro visits -->
        <includeIf velocityTest="$user.hasPrivilege('Task: emr.retroConsultNoteThisProviderOnly') and !($user.hasPrivilege('Task: emr.retroConsultNote')) and (!$visit.open)">
            <fieldset class="encounter-date required">
                <legend>
                    <uimessage code="emr.patientDashBoard.date"/>
                </legend>
                <h3>
                    <uimessage code="emr.patientDashBoard.date"/>
                </h3>

                <p class="left">
                    <encounterDate id="encounterDate" showTime="false" default="now"/>
                </p>
            </fieldset>

            <div style="display:none">
                <encounterProviderAndRole default="currentUser" encounterRole="4f10ad1a-ec49-48df-98c7-1391c6ac7f05" required="true"/>
            </div>

            <fieldset id="location" class="encounter-location required">
                <legend>
                    <uimessage code="emr.locationRequired"/>
                </legend>
                <h3>
                    <uimessage code="emr.locationRequired"/>
                </h3>

                <p class="left">
                    <encounterLocation required="true" tags="Check-In Location"/>
                </p>
            </fieldset>
        </includeIf>

        <!-- all users that don't have retroConsultNote privilege cannot edit provider, location or date when active visit -->
        <includeIf velocityTest="(!$user.hasPrivilege('Task: emr.retroConsultNote')) and ($visit.open)">
            <div style="display:none">
                <encounterProviderAndRole default="currentUser" encounterRole="4f10ad1a-ec49-48df-98c7-1391c6ac7f05" required="true"/>
                <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
                <encounterDate id="encounterDate" default="now" />
            </div>
        </includeIf>


        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.general_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.general_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:GENERAL EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:GENERAL EXAM FINDINGS" answerConceptId="PIH:CACHECTIC" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:GENERAL EXAM FINDINGS" answerConceptId="CIEL:115115" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:GENERAL EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="CIEL:160981" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.mental_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.mental_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="CIEL:163043" answerConceptId="PIH:NORMAL" style="checkbox" />
                </field>
                <field>
                    <obs conceptId="CIEL:163043" answerConceptId="PIH:DEPRESSION" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="CIEL:163043" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="CIEL:163044" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.skin_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.skin_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:SKIN EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:SKIN EXAM FINDINGS" answerConceptId="PIH:RASH" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:SKIN EXAM FINDINGS" answerConceptId="PIH:PALLOR" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:SKIN EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="PIH:SKIN EXAM COMMENT" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.heent_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.heent_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:HEENT EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:HEENT EXAM FINDINGS" answerConceptId="PIH:PALE CONJUNCTIVA" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:HEENT EXAM FINDINGS" answerConceptId="PIH:GOITER" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:HEENT EXAM FINDINGS" answerConceptId="PIH:LYMPHADENOPATHY" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:HEENT EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="PIH:SKIN EXAM COMMENT" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.cardiac_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.cardiac_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:CARDIAC EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:CARDIAC EXAM FINDINGS" answerConceptId="PIH:CARDIAC MURMUR" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:CARDIAC EXAM FINDINGS" answerConceptId="PIH:TACHYCARDIA" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:CARDIAC EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="CIEL:163046" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.chest_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.chest_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:CHEST EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:CHEST EXAM FINDINGS" answerConceptId="PIH:CREPITATIONS" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:CHEST EXAM FINDINGS" answerConceptId="PIH:WHEEZE" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:CHEST EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="CIEL:160689" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.abdominal_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.abdominal_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:ABDOMINAL EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:ABDOMINAL EXAM FINDINGS" answerConceptId="PIH:SPLENOMEGALY" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:ABDOMINAL EXAM FINDINGS" answerConceptId="PIH:HEPATOMEGALY" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:ABDOMINAL EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="CIEL:160947" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.urogenital_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.urogenital_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:UROGENITAL EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:UROGENITAL EXAM FINDINGS" answerConceptId="PIH:CANDIDIASIS" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:UROGENITAL EXAM FINDINGS" answerConceptId="PIH:GENITAL DISCHARGE" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:UROGENITAL EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="CIEL:163047" rows="5" cols="60" />
                </field>
            </p>

        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.musculoskeletal_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.musculoskeletal_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:MUSCULOSKELETAL EXAM FINDINGS" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:MUSCULOSKELETAL EXAM FINDINGS" answerConceptId="PIH:MUSCLE TENDERNESS" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:MUSCULOSKELETAL EXAM FINDINGS" answerConceptId="CIEL:118697" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:MUSCULOSKELETAL EXAM FINDINGS" answerConceptId="PIH:OTHER NON-CODED" style="checkbox" commentFieldLabel="specify:" />
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="CIEL:163048" rows="5" cols="60" />
                </field>
            </p>
        </fieldset>

        <fieldset id="gross-motor-skills-exam">
            <legend>
                <uimessage code="pihcore.exam.gross_motor_skills_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.gross_motor_skills_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:GROSS MOTOR SKILLS EVALUATION" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:GROSS MOTOR SKILLS EVALUATION" answerConceptId="PIH:ABNORMAL" style="checkbox"/>
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="PIH:Gross Motor Skills Evaluation (text)" rows="5" cols="60" />
                </field>
            </p>
        </fieldset>

        <fieldset id="fine-motor-skills-exam">
            <legend>
                <uimessage code="pihcore.exam.fine_motor_skills_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.fine_motor_skills_exam.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:FINE MOTOR SKILLS EVALUATION" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:FINE MOTOR SKILLS EVALUATION" answerConceptId="PIH:ABNORMAL" style="checkbox"/>
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="PIH:Fine Motor Skills Evaluation (text)" rows="5" cols="60" />
                </field>
            </p>
        </fieldset>

        <fieldset id="language-development-evaluation">
            <legend>
                <uimessage code="pihcore.exam.language_development_evaluation.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.language_development_evaluation.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:LANGUAGE DEVELOPMENT EVALUATION" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:LANGUAGE DEVELOPMENT EVALUATION" answerConceptId="PIH:ABNORMAL" style="checkbox"/>
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="PIH:Language Development Evaluation (text)" rows="5" cols="60" />
                </field>
            </p>
        </fieldset>

        <fieldset id="social-skills-evaluation">
            <legend>
                <uimessage code="pihcore.exam.social_skills_evaluation.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.social_skills_evaluation.title"/>
            </h3>

            <p>
                <field>
                    <obs conceptId="PIH:SOCIAL SKILLS EVALUATION" answerConceptId="PIH:NORMAL" style="checkbox"/>
                </field>
                <field>
                    <obs conceptId="PIH:SOCIAL SKILLS EVALUATION" answerConceptId="PIH:ABNORMAL" style="checkbox"/>
                </field>
            </p>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="PIH:Social Skills Evaluation (text)" rows="5" cols="60" />
                </field>
            </p>
        </fieldset>

        <fieldset>
            <legend>
                <uimessage code="pihcore.exam.other_exam.title"/>
            </legend>
            <h3>
                <uimessage code="pihcore.exam.other_exam.title"/>
            </h3>

            <p>
                <uimessage code="pihcore.exam.comment"/>
            </p>

            <p>
                <field>
                    <obs conceptId="PIH:PHYSICAL SYSTEM COMMENT" rows="5" cols="60"/>
                </field>
            </p>

        </fieldset>

    </section>

    <submit/>

</htmlform>